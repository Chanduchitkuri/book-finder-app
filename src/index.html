
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Finder App</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React and Babel for JSX -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
      body {
        font-family: 'Inter', sans-serif;
      }
    </style>
</head>
<body class="bg-gray-100">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const Header = () => {
            return (
                <header className="bg-blue-600 shadow-lg py-4 rounded-b-xl">
                    <div className="container mx-auto px-4 text-center">
                        <h1 className="text-white text-3xl md:text-4xl font-bold">Book Finder</h1>
                    </div>
                </header>
            );
        };

        const SearchBar = ({ onSearch }) => {
            const [query, setQuery] = useState('');
            const [searchType, setSearchType] = useState('title');

            const handleSubmit = (e) => {
                e.preventDefault();
                if (query.trim()) {
                    onSearch(query.trim(), searchType);
                }
            };

            return (
                <form onSubmit={handleSubmit} className="mb-8 p-4 bg-white rounded-lg shadow-xl">
                    <div className="flex flex-col md:flex-row items-center gap-4">
                        <div className="w-full">
                            <label htmlFor="search-input" className="sr-only">Search</label>
                            <input
                                id="search-input"
                                type="text"
                                placeholder="Search for a book by title, author, or subject..."
                                value={query}
                                onChange={(e) => setQuery(e.target.value)}
                                className="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            />
                        </div>
                        <div className="w-full md:w-auto">
                            <label htmlFor="search-type" className="sr-only">Search Type</label>
                            <select
                                id="search-type"
                                value={searchType}
                                onChange={(e) => setSearchType(e.target.value)}
                                className="w-full p-3 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500"
                            >
                                <option value="title">Title</option>
                                <option value="author">Author</option>
                                <option value="subject">Subject</option>
                            </select>
                        </div>
                        <button
                            type="submit"
                            className="w-full md:w-auto px-6 py-3 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500"
                        >
                            Search
                        </button>
                    </div>
                </form>
            );
        };

        const BookCard = ({ book }) => {
            const coverUrl = book.cover_i ? `https://covers.openlibrary.org/b/id/${book.cover_i}-M.jpg` : null;

            return (
                <div className="bg-white rounded-lg shadow-lg overflow-hidden flex flex-col items-center p-4 transform transition-transform hover:scale-105">
                    {coverUrl ? (
                        <img
                            src={coverUrl}
                            alt={`Cover of ${book.title}`}
                            className="w-full h-64 object-cover rounded-md mb-4"
                        />
                    ) : (
                        <div className="w-full h-64 bg-gray-200 flex items-center justify-center rounded-md mb-4">
                            <span className="text-gray-500 text-center p-2">No Cover Available</span>
                        </div>
                    )}
                    <div className="text-center flex-grow">
                        <h3 className="text-lg font-bold text-gray-800 mb-2">{book.title}</h3>
                        <p className="text-sm text-gray-600">by {book.author_name?.join(', ') || 'Unknown Author'}</p>
                        <p className="text-xs text-gray-500 mt-1">First Published: {book.first_publish_year || 'N/A'}</p>
                    </div>
                </div>
            );
        };

        const BookList = ({ books }) => {
            if (books.length === 0) {
                return <p className="text-center text-xl mt-8">No results found. Try a different search.</p>;
            }

            return (
                <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mt-8">
                    {books.map((book, index) => (
                        <BookCard key={index} book={book} />
                    ))}
                </div>
            );
        };

        const Footer = () => {
            return (
                <footer className="bg-gray-800 text-white py-4 mt-8 rounded-t-xl">
                    <div className="container mx-auto text-center text-sm">
                        <p>Developed by Chandu for the Aganitha Take-Home Challenge</p>
                        <p>Data provided by Open Library</p>
                    </div>
                </footer>
            );
        };

        function App() {
            const [books, setBooks] = useState([]);
            const [query, setQuery] = useState('');
            const [searchType, setSearchType] = useState('title');
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);
            const [showResults, setShowResults] = useState(false);

            useEffect(() => {
                if (query) {
                    fetchBooks();
                } else {
                    setBooks([]);
                }
            }, [query, searchType]);

            const fetchBooks = async () => {
                setLoading(true);
                setError(null);
                setShowResults(false);
                try {
                    const url = `https://openlibrary.org/search.json?${searchType}=${encodeURIComponent(query)}`;
                    const response = await fetch(url);
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    const data = await response.json();
                    setBooks(data.docs.filter(book => book.cover_i));
                } catch (err) {
                    setError("Failed to fetch books. Please try again.");
                } finally {
                    setLoading(false);
                    setShowResults(true);
                }
            };

            const handleSearch = (newQuery, newSearchType) => {
                setQuery(newQuery);
                setSearchType(newSearchType);
            };

            return (
                <div className="flex flex-col min-h-screen bg-gray-100 font-sans">
                    <Header />
                    <main className="container mx-auto flex-grow py-8 px-4">
                        <SearchBar onSearch={handleSearch} />
                        {loading && <p className="text-center text-lg mt-8">Loading books...</p>}
                        {error && <p className="text-center text-lg mt-8 text-red-500">{error}</p>}
                        {showResults && !loading && !error && <BookList books={books} />}
                    </main>
                    <Footer />
                </div>
            );
        }

        ReactDOM.render(
            <App />,
            document.getElementById('root')
        );
    </script>
</body>
</html>
